<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
  <head>
    <meta charset="utf-8">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="{{ .Description | default .Site.Params.Description }}">

    <title>
      {{ $url := replace .Permalink ( printf "%s" .Site.BaseURL) "" }}
      {{ if eq $url "/" }}
        {{ .Site.Title }}
      {{ else }}
        {{ if .Params.heading }} {{ .Params.heading }} {{ else }} {{ .Title }} {{ end }}
      {{ end }}
    </title>
    <link rel="canonical" href="{{ .Permalink }}">

    {{ partial "styles.html" . }}
    <link rel="stylesheet" href="/css/custom.css">
    
    <!-- Additional CSS for specific page types -->
    {{ if eq .Type "projects" }}
    <link rel="stylesheet" href="{{ "/css/projects.css" | relURL }}">
    {{ end }}
    
    {{ if eq .Type "blog" }}
    <link rel="stylesheet" href="{{ "/css/blog.css" | relURL }}">
    {{ end }}
    
    <!-- CSS for main pages (About, Research, Projects, and Blog listing) -->
    {{ if or (eq .Type "about") (eq .Type "research") (eq .Type "projects") (eq .Type "blog") }}
    <link rel="stylesheet" href="{{ "/css/main_pages.css" | relURL }}">
    {{ end }}

    {{ range .AlternativeOutputFormats -}}
        {{ printf `<link rel="%s" type="%s" href="%s" title="%s" />` .Rel .MediaType.Type .Permalink $.Site.Title | safeHTML }}
    {{ end -}}

    <!-- MathJax Configuration and Script -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          processEnvironments: true,
          tags: 'ams',
          tagSide: 'right',
          tagIndent: '.8em'
        },
        options: {
          skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        },
        startup: {
          pageReady: () => {
            return MathJax.startup.defaultPageReady().then(() => {
              console.log('MathJax initial typesetting complete');
            });
          }
        }
      };
    </script>
    <script type="text/javascript" id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">

    </script>
    
    <!-- Mobile-only table responsiveness script -->
    <script>
      // Only load table wrapper script on mobile devices
      if (window.innerWidth <= 768 || /Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
        var script = document.createElement('script');
        script.src = '/js/mobile-table-wrapper.js';
        document.head.appendChild(script);
      }
    </script>
  </head>

  <body>
    <section id="nav">
      <h1><a class="h-card" href="/">{{ .Site.Params.sitename }}</a></h1>
      <ul>
        {{ range .Site.Menus.main }}
          <li><a href="{{ .URL }}">{{ .Name }}</a></li>
        {{ end }}
      </ul>
    </section> 